codes from https://github.com/ARMmbed/mbedtls
version=2.22.0